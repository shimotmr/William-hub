# Forum #003 討論總結報告
## LINE Bot 智能客服品質優化

---

### 一、討論概況

**參與 Agent**: Travis (T), Researcher (R), Coder (C), Analyst (A), Writer (W), Inspector (I), Designer (D), Secretary (S)

**討論輪次**: 3 輪，共 29 則評論

**時間跨度**: 2026-02-15（從上午測試到下午完整討論）

**討論觸發**: 上午 LINE Bot 測試暴露 13 個問題，涵蓋 RAG、上下文、資料庫、回覆品質、基礎設施五大面向。雖然即時修復 11 個，但問題的根源是**缺乏完整測試場景規劃與可上線標準**。

---

### 二、核心共識

#### 1. 內容優先於演算法
- **數據佐證**: 13 個問題中，知識內容不足（31%）+ 資料庫邏輯錯誤（31%）佔 62%，RAG 召回失敗僅佔 15%
- **共識**: 知識庫品質是首要任務，搜尋引擎（BM25 → 混合搜尋）升級優先級最低
- **原因**: 混合搜尋增加成本（Voyage AI $0.12/1M tokens）和延遲（200-500ms），ROI 不高

#### 2. 轉人工是服務升級，不是 Bot 失敗
- **核心洞察** (Designer): 不應讓用戶感覺「Bot 不行，只好麻煩人工」
- **策略轉變**:
  - 產品選購類 → Bot 主動提供「需要業務詳細介紹嗎？」按鈕
  - 價格詢價類 → Bot 直接回覆「報價需根據數量和配置，為您安排專人報價」+ 立即預約按鈕
  - 技術支援類 → Bot 先給排查步驟，解決不了再轉人工
- **工單系統取代 Telegram 轟炸**: 不直接發通知，而是建工單到 Portal 統一管理

#### 3. 知識庫標準化 6 區塊格式
**Writer 提出的標準**（每個產品知識文件應包含）:
1. **基本規格** — 尺寸、重量、續航、水箱容量
2. **選購指南** — 適用場景、優劣勢比較、推薦搭配
3. **耗材清單** — 型號對應、更換週期、原廠vs副廠差異
4. **常見 FAQ** — 前 10 大客戶問題 + 標準回答
5. **故障排查** — 錯誤代碼表、初步排查步驟、何時轉人工
6. **搜尋關鍵字** — 同義詞、俗稱、常見打字錯誤

#### 4. Session 管理機制
- **問題**: 目前用「5 分鐘內訊息」作上下文，群組多人對話會互相干擾
- **解決**: 每個用戶獨立 session，Bot 自己的回覆也要存入 conversation_history
- **好處**: 正確追蹤上下文（「第一款」指的是什麼）

#### 5. 數據驅動品質改善
**4 個核心 KPI** (Analyst 提出):
1. **自動解決率** ≥60%（業界 B2B Bot 平均 50-65%）
2. **回覆準確率** ≥85%（每週抽查 20 則對話）
3. **平均回應時間** <3 秒
4. **轉人工率** <30%

**監控工具** (Researcher 提出):
- **LLM-as-Judge**: 用 GPT-4o-mini 自動評分（成本 $0.001/則，一天 100 則僅 $0.1）
- **隱式滿意度信號**: 自動分析用戶是否追問同一問題、是否說謝謝、是否主動轉人工
- **Dashboard**: Portal 新增 Bot 監控頁面（即時面板 + 品質面板 + 週報自動化）

#### 6. 測試驅動開發
**Inspector 提出最低驗收測試集**:
- 產品選購類 10 題（通過率 ≥80%）
- 規格參數類 10 題（通過率 ≥90%）
- 耗材維護類 8 題（通過率 ≥80%）
- 價格訂購類 5 題（轉人工率 100%）
- 技術支援類 7 題（排查步驟正確率 ≥70%）

---

### 三、行動計劃

| # | 任務 | 負責人 | 優先級 | 預估時間 | 看板編號 |
|---|------|--------|--------|----------|----------|
| 1 | 知識庫標準化：CC1/CC1 Pro/MT1 六區塊文件 | Writer | 🟡 | 3-5 天 | #100 |
| 2 | SQL LIKE 查詢修復（OR 條件 + 機型過濾） | Coder | 🟡 | 1 天 | #101 |
| 3 | chunk 拆分策略 + search_keywords 自動生成 | Coder | 🟡 | 2 天 | #102 |
| 4 | 測試案例集建立（40 題 5 大場景） | Inspector | 🟡 | 2 天 | #103 |
| 5 | 對話 session 機制 + Bot 回覆存入 DB | Coder | 🟡 | 2 天 | #104 |
| 6 | 轉人工工單系統（整合 Portal） | Coder | 🟡 | 3 天 | #105 |
| 7 | 服務升級 UX 流程設計 | Designer | 🟡 | 1 天 | #106 |
| 8 | bot_metrics 表 + 4 KPI 追蹤 | Analyst | 🟡 | 2 天 | #107 |
| 9 | LLM-as-Judge 自動評分 | Researcher | 🟡 | 2 天 | #108 |
| 10 | Dashboard UI 設計 | Designer | 🟡 | 1 天 | #109 |
| 11 | Dashboard 前端實作 | Coder | 🟡 | 3 天 | #110 |
| 12 | 完整測試驗收 | Inspector | 🟡 | 2 天 | #111 |
| 13 | **Webhook 穩定性改善：Tailscale → launchd** | Coder | 🔴 | 1 天 | **#112** |
| 14 | 品質週報自動化 + 隱式滿意度信號 | Analyst | 🟡 | 2 天 | **#113** |

**新建任務**: #112（Critical 級基礎設施修復）、#113（週報自動化）

---

### 四、技術方案摘要

#### 4.1 搜尋架構建議

**不採用混合搜尋** (BM25 + Embedding)，理由：
- 成本：Voyage AI $0.12/1M tokens，一天 100 次查詢可能破千/月
- 延遲：增加 200-500ms（API roundtrip）
- 依賴：需處理 rate limit、timeout

**採用知識庫優化 + 關鍵字 fallback**:
- 每個產品文件標準化 6 區塊（見第二節）
- 自動生成 search_keywords（同義詞、俗稱、常見打字錯誤）
- chunk 拆分：每個區塊獨立 chunk，FAQ 每個 Q&A 獨立，metadata 標記 section_type

#### 4.2 知識庫標準化方案

**6 區塊標準格式** (Writer 提出):
```
產品名稱.md
├── 1. 基本規格
├── 2. 選購指南（新增）
├── 3. 耗材清單（新增）
├── 4. 常見 FAQ（新增）
├── 5. 故障排查（新增）
└── 6. 搜尋關鍵字（新增）
```

**chunk 策略** (Coder 提出):
- 每個區塊獨立成一個 chunk（不是整篇文件一個 chunk）
- FAQ 每個 Q&A 獨立 chunk
- metadata: `product_id`, `section_type`, `question`（FAQ 專用）

**驗收標準** (Inspector 提出):
- 40 題測試案例（5 大場景）
- 產品選購 ≥80%、規格參數 ≥90%、耗材維護 ≥80%

#### 4.3 轉人工機制設計

**觸發條件**:
1. 分類結果為「訂購」或「技術支援」
2. 用戶明確要求（「我要找業務」「幫我轉接客服」）
3. Bot 連續 2 次無法回答（信心度 <0.3）

**UX 流程** (Designer 提出):
- **產品選購** → Bot 先給建議，再提供「需要業務詳細介紹？」按鈕
- **價格詢價** → Bot 直接回「報價需根據數量和配置，為您安排專人報價」+ 立即預約按鈕
- **技術支援** → Bot 先給排查步驟，解決不了再轉

**工單系統** (Coder 提出):
```sql
CREATE TABLE support_requests (
  id, user_id, chat_id, 
  request_type, -- '產品選購'/'報價'/'技術支援'
  question_summary, -- LLM 自動摘要
  bot_context, -- Bot 已提供的資訊
  assignee, priority, status,
  created_at, resolved_at
)
```

**業務分派規則**:
- 產品線自動分派（CC1 系列 → 業務 A、MT1 系列 → 業務 B）
- 優先級自動判斷（訂購 > 技術支援 > 諮詢）
- Portal 統一管理，不直接發 Telegram 通知（避免轟炸）

#### 4.4 監控 KPI 定義

**4 個核心指標** (Analyst 提出):

| KPI | 定義 | 目標值 | 計算方式 |
|-----|------|--------|----------|
| 自動解決率 | Bot 完整回答且用戶未轉人工的比例 | ≥60% | (總對話 - 轉人工數) / 總對話 |
| 回覆準確率 | Bot 回答正確的比例 | ≥85% | 每週抽查 20 則，人工標記正確/錯誤 |
| 平均回應時間 | 從收到訊息到回覆的時間 | <3 秒 | avg(reply_time - received_time) |
| 轉人工率 | 需要人工介入的對話比例 | <30% | 轉人工數 / 總對話 |

**LLM-as-Judge** (Researcher 提出):
- 用 GPT-4o-mini 自動評分 Bot 回覆品質（1-5 分）
- 成本：每則 $0.001，一天 100 則僅 $0.1
- 取代大部分人工抽檢，只需複查低分案例

**隱式滿意度信號** (Researcher 提出):
- 用戶是否追問同一問題（=不滿意）
- 用戶是否說「謝謝」（=滿意）
- 用戶是否主動要求轉人工（=不滿意）
- 從 conversation_history 自動分析，不需明確滿意度調查

**Dashboard** (Designer 提出):
- **即時面板**: 今日對話數/自動解決數/轉人工數、最近 7 天趨勢線
- **品質面板**: 本週準確率、低分對話列表、知識庫覆蓋率熱力圖
- **週報自動化**: 每週一自動生成 Bot 品質週報推送 Telegram

---

### 五、四週實施路線圖

#### Week 1：知識庫 + 資料庫修復（基礎品質）
**目標**: 讓 Bot 能正確回答基本問題

| 任務 | 負責人 | 看板 |
|------|--------|------|
| CC1/CC1 Pro/MT1 六區塊標準化知識文件 | Writer | #100 |
| SQL LIKE 查詢邏輯修復 | Coder | #101 |
| chunk 拆分策略 + search_keywords 自動生成 | Coder | #102 |
| 建立 40 題測試案例集 | Inspector | #103 |
| **🔴 Webhook 穩定性改善（Critical）** | Coder | **#112** |

**驗收標準**: 測試案例通過率 ≥80%

---

#### Week 2：上下文 + 轉人工（體驗優化）
**目標**: 讓 Bot 理解上下文，優雅地轉人工

| 任務 | 負責人 | 看板 |
|------|--------|------|
| Bot 回覆存入 conversation_history + session 機制 | Coder | #104 |
| 轉人工工單系統（整合 Portal） | Coder | #105 |
| 服務升級 UX 流程設計 | Designer | #106 |

**驗收標準**: 
- 上下文追蹤準確率 ≥90%（測試「第一款」等代詞）
- 工單系統正常運作，業務能在 Portal 看到並處理

---

#### Week 3：監控 + Dashboard（數據驅動）
**目標**: 建立持續改善的數據基礎

| 任務 | 負責人 | 看板 |
|------|--------|------|
| bot_metrics 表 + 4 KPI 追蹤 | Analyst | #107 |
| LLM-as-Judge 自動評分 | Researcher | #108 |
| Dashboard UI 設計 | Designer | #109 |
| Dashboard 前端實作 | Coder | #110 |
| 品質週報自動化 + 隱式滿意度信號 | Analyst | #113 |

**驗收標準**:
- Dashboard 能即時顯示 4 個 KPI
- LLM-as-Judge 每日自動評分並記錄到 DB
- 每週一自動推送品質週報到 Telegram

---

#### Week 4：全面測試 + 線上監控（上線準備）
**目標**: 確保 Bot 可以安全上線

| 任務 | 負責人 | 看板 |
|------|--------|------|
| 完整測試驗收（40 題 + 壓力測試） | Inspector | #111 |
| 72 小時穩定性監控 | Inspector | - |
| Beta 測試（少量客戶） | Travis | - |

**上線標準**:
- 自動解決率 ≥60%
- 回覆準確率 ≥85%
- Webhook 穩定性 ≥99.9%（72 小時無漏收）
- 轉人工工單系統正常運作

---

### 六、待 William 決策事項

#### 1. 混合搜尋是否需要？
**背景**: Researcher 提出混合搜尋（BM25 + Embedding）可提升召回率，但 Coder 反對因成本和延遲問題。

**團隊共識**: 先以知識庫優化為主，混合搜尋優先級最低

**需決策**: 是否同意此優先級排序？或要求必須實作混合搜尋？

---

#### 2. 工單系統整合範圍
**背景**: Coder 提出工單系統整合到 Portal，Designer 建議加入業務分派規則。

**團隊建議**: 
- 第一版：基本工單建立 + Portal 顯示
- 第二版：自動分派（產品線、優先級）
- 第三版：整合 CRM（未來）

**需決策**: 第一版範圍是否足夠？或需要一次到位包含自動分派？

---

#### 3. Beta 測試範圍與時間
**背景**: Week 4 計劃包含 Beta 測試，但未定義範圍。

**需決策**:
- 測試對象：哪些經銷商？幾家？
- 測試時間：多久？1 週？2 週？
- 失敗標準：什麼情況下暫停 Beta？

---

#### 4. 長期成本控制
**背景**: LLM-as-Judge（GPT-4o-mini）每日成本約 $0.1，一個月約 $3。若對話量增加可能破百。

**需決策**: 
- 是否接受此成本？
- 是否需要設定月成本上限？
- 對話量增加時的成本控制策略？

---

#### 5. 人力資源分配
**背景**: Coder 負責 7 個任務（#101, #102, #104, #105, #110, #112, #113 的部分），可能成為瓶頸。

**需決策**:
- 是否需要調整任務分配？
- 是否需要外部開發資源？
- 哪些任務可以降低優先級？

---

### 七、風險評估

#### 🔴 Critical 風險
1. **Webhook 穩定性** — 目前偶爾漏收訊息，已列為 #112（最高優先級）
2. **Coder 工作負載過重** — 7 個任務可能導致進度延遲

#### 🟡 中等風險
1. **知識庫完整性** — Writer 3-5 天可能不夠（需持續擴充）
2. **測試覆蓋率** — 40 題測試案例可能無法涵蓋所有情境
3. **工單系統與現有業務流程整合** — 需確認經銷商願意透過 Portal 處理

#### 🔵 低風險
1. **LLM-as-Judge 準確性** — 可能需要人工覆核調整評分標準
2. **Dashboard 前端效能** — 對話量大時可能需要優化

---

### 八、成功指標

**4 週後應達成**:
- ✅ 知識庫標準化完成（CC1/CC1 Pro/MT1 至少）
- ✅ 測試案例通過率 ≥80%
- ✅ Webhook 穩定性 ≥99.9%
- ✅ 工單系統上線並整合 Portal
- ✅ Dashboard 即時顯示 4 個 KPI
- ✅ LLM-as-Judge 自動評分運作正常

**上線後 1 個月應達成**:
- ✅ 自動解決率 ≥60%
- ✅ 回覆準確率 ≥85%
- ✅ 轉人工率 <30%
- ✅ 平均回應時間 <3 秒
- ✅ 品質週報自動推送運作正常

---

**報告產出時間**: 2026-02-15 14:00 (GMT+8)  
**報告產出者**: Writer (Sub-agent)  
**資料來源**: Forum #003 討論（29 則評論）
